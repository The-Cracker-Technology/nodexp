#Rules for nodexp detection
alert tcp any any -> any any (msg:"Possible SSJI exploit - Python UA"; flow:to_server, established; content:"Python-urllib"; http_header; sid:1000013; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST payload HEX Detection"; flow:to_server, established; content:"|41 44 27 29|"; http_client_body; sid:1000011; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST eval HEX Detection"; flow:to_server, established; content:"|65 76 61 6C|"; http_client_body; sid:1000012; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST res.end HEX Detection"; flow:to_server, established; content:"|72 65 73 2E 65 6E 64|"; http_client_body; sid:1000015; classtype: web-application-attack; rev:1;) 
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST response.end HEX Detection"; flow:to_server, established; content:"|72 65 73 70 6F 6E 73 65 2E 65 6E 64|"; http_client_body; sid:1000014; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET payload HEX Detection"; flow:to_server, established; content:"|41 44 27 29|"; http_uri; sid:1000016; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET eval HEX Detection"; flow:to_server, established; content:"|65 76 61 6C|"; http_uri; sid:1000017; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET res.end HEX Detection"; flow:to_server, established; content:"|72 65 73 2E 65 6E 64|"; http_uri; sid:1000018; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET response.end HEX Detection"; flow:to_server, established; content:"|72 65 73 70 6F 6E 73 65 2E 65 6E 64|"; http_uri; sid:1000019; classtype: web-application-attack; rev:1;) 
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST res.end Detection"; flow:to_server, established; content:"res.end"; nocase; http_client_body; sid:1000023; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST response.end Detection"; flow:to_server, established; content:"response.end"; nocase; http_client_body; sid:1000031; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST eval Detection"; flow:to_server, established; content:"eval"; nocase; http_client_body; sid:1000024; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET res.end Detection"; flow:to_server, established; content:"res.end"; nocase; http_uri; sid:1000025; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET response.end Detection"; flow:to_server, established; content:"response.end"; nocase; http_uri; sid:1000026; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET eval Detection"; flow:to_server, established; content:"eval"; nocase; http_uri; sid:1000027; classtype: web-application-attack; rev:1;) 
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET res.end URL encoding Detection"; flow:to_server, established; pcre:"/res.end\%\w*\%\d*/"; sid:1000029; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET response.end URL encoding Detection"; flow:to_server, established; pcre:"/response.end\%\w*\%\d*/"; sid:1000030; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-GET eval URL encoding Detection"; flow:to_server, established; pcre:"/eval\%\d*\w*\%\w*\%\d*/"; sid:1000028; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST eval multiplication detection"; flow:to_server, established; pcre:"/eval\(\d*\*\d*\)/"; sid:1000010; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST eval devision detection"; flow:to_server, established; pcre:"/eval\(\d*\/\d*\)/"; sid:1000032; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST res.end random string detection"; pcre:"/res\.end\(.*\)$/"; sid:1000021; classtype: web-application-attack; rev:1;)
alert tcp any any -> any any (msg:"Possible SSJI exploit-POST response.end random string detection"; pcre:"/response\.end\(.*\)$/"; sid:1000022; classtype: web-application-attack; rev:1;) 